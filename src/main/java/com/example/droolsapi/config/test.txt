from datetime import date

gx = spark._jvm.org.example.drools.GenericExecutor()

# 1 test row to hit A1CIPRiskRule
rows = [
    (
        1,              # indv_id
        478,            # elem_nbr -> matches rule
        1.0,            # elem_qty
        45,             # age
        "INDV_SCOR_FACT", # mem_name -> matches rule
        date(2025,1,1), # elem_dt_1
        date(2025,2,1), # elem_dt_2
        "FUT_RSK_IN",   # scor_typ_cd -> matches
        3.5,            # scor_val >= 3.0
        "codeX", "2025-01-01", "2025-01-15", "ST1", "SEG1",
        "2025-01-10", "2025-01-20", "RULE1", "1990-01-01",
        "2025-02-01", "2025-03-01", "DX1", "SCN1", "2025-02-15",
        123, "2025-01-01", "2025-05-01", "complaint", "supX",
        "cont", "medcov", 1.1, 2.2
    )
]

for row in rows:
    gx.process(*row)

results = gx.endPartition().toArray()
for r in results:
    print("STATUS =", r.getStatus())
